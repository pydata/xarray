[project]
preview = ["pixi-build"]
channels = ["conda-forge", "nodefaults"]
platforms = ["win-64", "linux-64", "osx-64", "osx-arm64"]


[tasks]
test = { cmd = "pytest" }

[tasks.test-all]
depends-on = [
  { task = "test", environment = "test" },
  { task = "test", environment = "test-bare-min" },
]

[environments]
test = { features = ["test"], solve-group = "test" }
test-bare-min = { features = ["test", "minimal"], solve-group = "test" }
pre-commit = { features = ["pre-commit"], no-default-feature = true }

[dependencies]
python = "*"
numpy = "*"
pandas = "*"

packaging = "24.1.*" #? Can be removed?
git = "*"            # needed for dynamic versioning

[feature.minimal.dependencies]
python = "3.11.*"
numpy = "1.26.*"
pandas = "2.2.*"


[feature.test.dependencies]
pytest = "*"
pytest-asyncio = "*"
pytest-cov = "*"
pytest-env = "*"
pytest-mypy-plugins = "*"
pytest-timeout = "*"
pytest-xdist = "*"
coveralls = "*"

[feature.pre-commit.dependencies]
pre-commit = "*"

[feature.pre-commit.tasks]
pre-commit = { cmd = "pre-commit run --all-files" }


[package]
name = "xarray"
version = "dynamic" # dynamic versioning needs better support in pixi https://github.com/prefix-dev/pixi/issues/2923#issuecomment-2598460666 . Putting `version = "dynamic"` here for now until pixi recommends something else.

[package.build]
backend = { name = "pixi-build-python", version = "==0.3.2" }

[package.host-dependencies]
setuptools = "*"
setuptools_scm = "*"
